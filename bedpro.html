<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BedPro - Sleepsim</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/bedpro.css">
    <style>
        html, body, nav, div, span, a, img, button {
            cursor: url('img/mouse.png') 32 32, auto !important;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-left">
            <a href="index.html" class="nav-logo-link">
                <img src="img/logo.webp" alt="Logo" class="nav-logo">
            </a>
        </div>
        <div class="nav-links">
            <a href="about2.html" class="nav-link">ABOUT</a>
            <a href="donation.html" class="nav-link">헌금하기</a>
            <a href="donation.html?step=ripmind" class="nav-link">R.I.P</a>
            <a href="bedpro.html" class="nav-link">취침시간 지연 활동</a>
            <a href="bedpro-test.html" class="nav-link nav-link-test">진단하기</a>
            <a href="product.html" class="nav-link">PRODUCT</a>
            <a href="bible.html" class="nav-link">✟ BIBLE ✟</a>
        </div>
        
        <!-- 햄버거 바 -->
        <div class="hamburger" id="hamburger">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </div>
    </nav>

    <!-- 모바일 메뉴 -->
    <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-content">
            <a href="about2.html" class="mobile-nav-link">ABOUT</a>
            <a href="donation.html" class="mobile-nav-link">헌금하기</a>
            <a href="donation.html?step=ripmind" class="mobile-nav-link">R.I.P</a>
            <a href="bedpro.html" class="mobile-nav-link">취침시간 지연 활동</a>
            <a href="bedpro-test.html" class="mobile-nav-link">진단하기</a>
            <a href="product.html" class="mobile-nav-link">PRODUCT</a>
            <a href="bible.html" class="mobile-nav-link">✟ BIBLE ✟</a>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Image Container with Overlay -->
            <div class="image-container" id="main-section">
                <img src="img_bedpro/error1.webp" alt="Error" class="bedpro-image">
                <img src="img_bedpro/yes.webp" alt="Yes" class="overlay-image yes-overlay" id="yes-image">
                <img src="img_bedpro/no.webp" alt="No" class="overlay-image no-overlay" id="no-image">
            </div>

            <!-- Error Modal -->
            <div class="error-modal" id="error-modal">
                <img src="img_bedpro/error.webp" alt="Error" class="error-full-image">
            </div>
        </div>
    </main>

    <!-- Webcam Section -->
    <div class="webcam-section">
        <video id="webcam" autoplay muted playsinline></video>
        <div class="webcam-overlay">
            <h2>겪었다면,<br>당신은 이미 취침시간 지연행동자입니다.</h2>
        </div>
    </div>

    <!-- Next Section -->
    <div class="next-section">
        <div class="next-content">
            <h2>낮에는 지치고 밤에는 깨어나고 아침에는 도망치고 다시 밤에는 
                핸드폰을 붙들고 자고 싶어도 세상은 막고 일찍 자야지 다짐해도 
                또 늦게 자고 잠들면 보상을 빼앗긴 듯 허무하고 출근 전엔 졸리다 
                가기 싫다 중얼거리지만 집에 오면 미처 못 본 영상의 늪에 빠지고 
                잠은 습관이 되었으나 습관은 잠을 거부하고 누우면 깨어나고 할일은 
                넘치고 우주는 그대를 못 자게 만들고 졸린데도 하루는 짧고 시간은 
                아깝고 잡생각은 쏟아지고 잠들면 내일이 오기에 두렵고 회피는 반복되고 
                영상은 이것만 보고 자야지라는 속삭임으로 밤을 연장하고 바쁘게 일하고 
                와도 바로 잠드는 건 죄악처럼 느껴지고 억울함은 또 다른 밤을 열고 
                결국 부장도 세상도 우주도 그대를 재워주지 않는다</h2>
            
            <video id="webcam2" class="webcam2" autoplay muted playsinline></video>
        </div>
    </div>

    <!-- New Section -->
    <div class="new-section" id="new-section">
        <div class="new-content">
            <h2 class="question-title">왜 사람들은 피곤하면서도,<br>다른 활동을 하면서 취침시간을 미루는 걸까요?</h2>
            
            <video id="webcam3" class="webcam3" autoplay muted playsinline></video>
        </div>
    </div>

    <!-- New Section Below Webcam3 -->
    <div class="section-below-webcam3">
        <div class="section-below-content">
            <img src="img_bedpro/4img.webp" alt="4img" class="section4-image">
        </div>
    </div>

    <!-- Section 5 -->
    <div class="section5">
        <img src="img_bedpro/bedprotestbg.webp" alt="bedprotestbg" class="section5-bg-image">
        <!-- Ribbon -->
        <div class="ribbon">
            <div class="ribbon-text">SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp; SLEEPISM 🛌 &nbsp;&nbsp;&nbsp;</div>
        </div>
        <!-- Button -->
        <a href="bedpro-test.html" class="section5-test-button">취침지연 테스트 하러가기</a>
    </div>

    <!-- Section 6 -->
    <div class="section6"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <a href="index.html" class="footer-logo-link">
                <img src="img/footerlogo.webp" alt="Footer Logo" class="footer-logo">
            </a>
            <div class="footer-copyright">
                <div class="copyright-text">청주대학교 디지털미디어디자인학과</div>
                <div class="copyright-text">제5회 졸업전시 작품 SLEEPISM</div>
            </div>
            <div class="footer-copyright1">
            <div class="copyright-text">© 2025, SLEEPISM🪽 All rights reserved.</div>
        </div>
            <div class="footer-info">
                <div class="footer-info-item">전시공간 &nbsp; &nbsp;  충북 청주시 청원구 안덕벌로 19번길 116</div>
                <div class="footer-info-item">전시일정  &nbsp;&nbsp;  12/12 ~ 12/15</div>
                <div class="footer-info-item">인스타그램  &nbsp;&nbsp;  @SLEEP1SM</div>
                <div class="footer-info-item">문의전화  &nbsp;&nbsp;  010 - 6824 -0363</div>
            </div>
            <img src="img/foooter.png" alt="Footer" class="footer-image">
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const hamburger = document.getElementById('hamburger');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (hamburger && mobileMenu) {
                hamburger.addEventListener('click', function() {
                    hamburger.classList.toggle('active');
                    mobileMenu.classList.toggle('active');
                });
            }

            // 초기 스크롤 비활성화
            document.body.style.overflow = 'hidden';

            // Yes 이미지 클릭 시 스크롤 활성화 및 웹캠 시작
            const yesImage = document.getElementById('yes-image');
            const webcam = document.getElementById('webcam');
            const webcamSection = document.querySelector('.webcam-section');
            
            if (yesImage && webcam && webcamSection) {
                yesImage.addEventListener('click', function() {
                    // 스크롤 활성화 (가로 스크롤은 비활성화 유지)
                    document.body.style.overflow = 'auto';
                    document.body.style.overflowX = 'hidden';
                    document.documentElement.style.overflowX = 'hidden';
                    
                    // 웹캠 섹션으로 스크롤
                    webcamSection.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // 모든 웹캠을 한 번의 스트림으로 시작
                    startAllWebcams();
                    
                    // 페이드 크로스 애니메이션 설정
                    setupFadeCrossAnimation();
                });
            }

            // 모든 웹캠을 한 번의 스트림으로 시작하는 함수
            async function startAllWebcams() {
                try {
                    // 웹캠 스트림 한 번만 가져오기
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            width: { ideal: 1920 },
                            height: { ideal: 1080 }
                        } 
                    });
                    
                    // 첫 번째 웹캠
                    webcam.srcObject = stream;
                    
                    // 두 번째 웹캠 (같은 스트림 공유)
                    const webcam2 = document.getElementById('webcam2');
                    if (webcam2) {
                        webcam2.srcObject = stream;
                    }
                    
                    // 세 번째 웹캠 (같은 스트림 공유)
                    const webcam3 = document.getElementById('webcam3');
                    if (webcam3) {
                        webcam3.srcObject = stream;
                    }
                    
                    // 웹캠이 로드된 후 텍스트 표시
                    webcam.onloadedmetadata = function() {
                        setTimeout(() => {
                            const overlay = document.querySelector('.webcam-overlay');
                            if (overlay) {
                                overlay.style.opacity = '1';
                            }
                        }, 500);
                    };
                } catch (err) {
                    console.error('웹캠 접근 실패:', err);
                    alert('웹캠에 접근할 수 없습니다. 브라우저 설정을 확인해주세요.');
                }
            }

            // 페이드 크로스 애니메이션 설정
            function setupFadeCrossAnimation() {
                const webcamSection = document.querySelector('.webcam-section');
                const nextSection = document.querySelector('.next-section');
                const footer = document.querySelector('.footer');
                
                if (webcamSection && nextSection) {
                    // Intersection Observer 설정
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                // 넥스트 섹션이 화면에 들어오면 페이드 크로스 실행
                                webcamSection.classList.add('fade-out');
                                nextSection.classList.add('fade-in');
                            } else {
                                // 넥스트 섹션이 화면에서 벗어나면 원래대로
                                webcamSection.classList.remove('fade-out');
                                nextSection.classList.remove('fade-in');
                            }
                        });
                    }, {
                        threshold: 0.3, // 30% 보이면 트리거
                        rootMargin: '0px 0px -100px 0px' // 아래쪽 100px 여유
                    });
                    
                    // 넥스트 섹션 관찰 시작
                    observer.observe(nextSection);
                }

                // 푸터 관찰을 위한 별도 Observer
                if (nextSection && footer) {
                    const footerObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                // 푸터가 화면에 들어오면 넥스트 섹션에 scroll-out 클래스 추가
                                nextSection.classList.add('scroll-out');
                            } else {
                                // 푸터가 화면에서 벗어나면 scroll-out 클래스 제거
                                nextSection.classList.remove('scroll-out');
                            }
                        });
                    }, {
                        threshold: 0.1, // 10% 보이면 트리거
                        rootMargin: '0px 0px -200px 0px' // 아래쪽 200px 여유
                    });
                    
                    // 푸터 관찰 시작
                    footerObserver.observe(footer);
                }
            }

            // No 이미지 클릭 시 에러 모달 표시 및 에러 소리
            const noImage = document.getElementById('no-image');
            const errorModal = document.getElementById('error-modal');

            // 에러 소리 생성 함수
            function playErrorSound() {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // 전형적인 에러 사운드 (낮은 톤 + 높은 톤)
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.1);
                oscillator.frequency.setValueAtTime(100, audioContext.currentTime + 0.2);
                oscillator.frequency.setValueAtTime(400, audioContext.currentTime + 0.3);
                oscillator.frequency.setValueAtTime(300, audioContext.currentTime + 0.4);
                
                gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.6);
            }

            if (noImage && errorModal) {
                noImage.addEventListener('click', function() {
                    // 에러 모달 표시
                    errorModal.classList.add('show');
                });

                // 에러 모달이 표시될 때 에러 소리 재생
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                            if (errorModal.classList.contains('show')) {
                                playErrorSound();
                            }
                        }
                    });
                });
                
                observer.observe(errorModal, { attributes: true });

                // 모달 배경 클릭 시 닫기
                errorModal.addEventListener('click', function() {
                    errorModal.classList.remove('show');
                });
            }

            // New Section 애니메이션 설정
            function setupNewSectionAnimation() {
                const newSection = document.getElementById('new-section');
                
                if (newSection) {
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                // 섹션이 화면에 들어오면 애니메이션 시작
                                newSection.classList.add('animate');
                            }
                        });
                    }, {
                        threshold: 0.2, // 20% 보이면 트리거
                        rootMargin: '0px 0px -50px 0px'
                    });
                    
                    observer.observe(newSection);
                }
            }

            // New Section 애니메이션 초기화
            setupNewSectionAnimation();

        });
    </script>
</body>
</html>